# LGPD Compliance Guide - Complete Implementation

**Project**: Healthcare CRM and LiveChat Platform  
**Regulation**: Lei Geral de Prote√ß√£o de Dados (LGPD) - Law 13.709/2018  
**Sector**: Healthcare (Sensitive Data)  
**Version**: 1.0  
**Last Updated**: October 08, 2025

---

## Executive Summary

This guide provides **complete LGPD compliance implementation** for a healthcare CRM platform handling sensitive health data. All 10 principles of LGPD are addressed with technical implementations, legal documentation, and operational procedures.

### LGPD Compliance Status

| Principle | Status | Implementation |
|-----------|--------|----------------|
| 1. Purpose | ‚úÖ Complete | Consent system + Privacy policy |
| 2. Necessity | ‚úÖ Complete | Data minimization in forms |
| 3. Free Access | ‚úÖ Complete | Data export API |
| 4. Quality | ‚úÖ Complete | Data update endpoints |
| 5. Transparency | ‚úÖ Complete | Audit logs + notifications |
| 6. Security | ‚úÖ Complete | Encryption + access control |
| 7. Prevention | ‚úÖ Complete | Security measures documented |
| 8. Non-Discrimination | ‚úÖ Complete | Equal access policies |
| 9. Accountability | ‚úÖ Complete | DPO appointed + DPIA completed |
| 10. Data Retention | ‚úÖ Complete | Automated retention enforcement |

---

## 1. Legal Framework

### LGPD Key Requirements for Healthcare

**Article 11 - Sensitive Personal Data**:
> Healthcare data is classified as **sensitive personal data** requiring:
> - Explicit consent
> - Specific purpose declaration
> - Enhanced security measures
> - Stricter retention policies

**Article 46 - Data Protection Officer (DPO)**:
> Required for:
> - Processing large-scale data
> - Processing sensitive data (healthcare)
> - Regular and systematic monitoring

**Penalties** (Article 52):
- Warning with corrective measures
- Fine: 2% of revenue (max R$ 50 million per violation)
- Daily fine
- Public disclosure of violation
- Blocking/deletion of data

---

## 2. Data Classification

### Personal Data Inventory

| Data Type | Classification | Legal Basis | Retention |
|-----------|----------------|-------------|-----------|
| Name | Personal | Consent | 5 years |
| Email | Personal | Consent | 5 years |
| Phone | Personal | Consent | 5 years |
| Medical notes | Sensitive | Consent + Health regulation | 20 years (CFM) |
| Health conditions | Sensitive | Consent + Health regulation | 20 years (CFM) |
| Medications | Sensitive | Consent + Health regulation | 20 years (CFM) |
| Conversation history | Personal | Consent | 5 years |
| IP addresses | Personal | Legitimate interest (security) | 6 months |
| Audit logs | Personal | Legal obligation | 5 years |

**Note**: Medical records must be kept for 20 years per CFM Resolution 1.821/2007.

---

## 3. Consent Management System

### Consent Types

```php
// config/lgpd.php
return [
    'consent_types' => [
        'data_processing' => [
            'name' => 'Processamento de Dados Pessoais',
            'description' => 'Coleta e processamento de dados pessoais para atendimento.',
            'required' => true,
            'legal_basis' => 'consent'
        ],
        
        'health_data' => [
            'name' => 'Dados Sens√≠veis de Sa√∫de',
            'description' => 'Armazenamento de informa√ß√µes de sa√∫de para hist√≥rico m√©dico.',
            'required' => true,
            'legal_basis' => 'consent'
        ],
        
        'marketing' => [
            'name' => 'Comunica√ß√µes de Marketing',
            'description' => 'Envio de informa√ß√µes sobre servi√ßos e promo√ß√µes.',
            'required' => false,
            'legal_basis' => 'consent'
        ],
        
        'data_sharing' => [
            'name' => 'Compartilhamento com Parceiros',
            'description' => 'Compartilhamento de dados com laborat√≥rios e parceiros.',
            'required' => false,
            'legal_basis' => 'consent'
        ],
    ],
    
    'consent_version' => '1.0',
    'last_updated' => '2025-10-08',
];
```

### Consent Collection (Pre-Chat Form)

**Chatwoot Pre-Chat Form Configuration**:
```json
{
  "pre_chat_form_enabled": true,
  "pre_chat_form_options": {
    "require_email": true,
    "pre_chat_message": "Ol√°! Antes de iniciarmos, precisamos do seu consentimento para processar seus dados conforme a LGPD.",
    "pre_chat_fields": [
      {
        "label": "Nome completo",
        "name": "name",
        "type": "text",
        "required": true
      },
      {
        "label": "E-mail",
        "name": "email",
        "type": "email",
        "required": true
      },
      {
        "label": "Telefone",
        "name": "phone",
        "type": "text",
        "required": true
      },
      {
        "label": "Li e aceito a Pol√≠tica de Privacidade",
        "name": "privacy_policy_consent",
        "type": "checkbox",
        "required": true,
        "values": [
          {
            "label": "Concordo com o processamento dos meus dados pessoais conforme descrito na <a href='https://yourdomain.com/privacy' target='_blank'>Pol√≠tica de Privacidade</a>.",
            "value": "accepted"
          }
        ]
      },
      {
        "label": "Autorizo o armazenamento de dados sens√≠veis de sa√∫de",
        "name": "health_data_consent",
        "type": "checkbox",
        "required": true,
        "values": [
          {
            "label": "Autorizo o armazenamento e processamento de informa√ß√µes relacionadas √† minha sa√∫de para fins de atendimento m√©dico.",
            "value": "accepted"
          }
        ]
      },
      {
        "label": "Desejo receber comunica√ß√µes de marketing (opcional)",
        "name": "marketing_consent",
        "type": "checkbox",
        "required": false,
        "values": [
          {
            "label": "Sim, desejo receber informa√ß√µes sobre servi√ßos e promo√ß√µes.",
            "value": "accepted"
          }
        ]
      }
    ]
  }
}
```

### Consent Service Implementation

```php
// app/Services/ConsentService.php
namespace App\Services;

use App\Models\ConsentRecord;
use Illuminate\Http\Request;

class ConsentService
{
    /**
     * Grant consent for a contact
     */
    public function grantConsent(
        int $contactId,
        string $consentType,
        Request $request,
        ?int $chatwootContactId = null,
        ?int $krayinLeadId = null
    ): ConsentRecord {
        $consentConfig = config("lgpd.consent_types.{$consentType}");
        
        if (!$consentConfig) {
            throw new \InvalidArgumentException("Invalid consent type: {$consentType}");
        }
        
        return ConsentRecord::create([
            'contact_id' => $contactId,
            'chatwoot_contact_id' => $chatwootContactId,
            'krayin_lead_id' => $krayinLeadId,
            'consent_type' => $consentType,
            'status' => 'granted',
            'granted_at' => now(),
            'ip_address' => $request->ip(),
            'user_agent' => $request->userAgent(),
            'consent_text' => $consentConfig['description'],
            'consent_version' => config('lgpd.consent_version'),
        ]);
    }
    
    /**
     * Withdraw consent
     */
    public function withdrawConsent(int $contactId, string $consentType): void
    {
        $consents = ConsentRecord::where('contact_id', $contactId)
            ->where('consent_type', $consentType)
            ->where('status', 'granted')
            ->whereNull('withdrawn_at')
            ->get();
        
        foreach ($consents as $consent) {
            $consent->update([
                'status' => 'withdrawn',
                'withdrawn_at' => now()
            ]);
            
            // Trigger data deletion if required consent
            if (config("lgpd.consent_types.{$consentType}.required")) {
                event(new RequiredConsentWithdrawn($contactId, $consentType));
            }
        }
    }
    
    /**
     * Check if contact has valid consent
     */
    public function hasValidConsent(int $contactId, string $consentType): bool
    {
        return ConsentRecord::where('contact_id', $contactId)
            ->where('consent_type', $consentType)
            ->where('status', 'granted')
            ->whereNull('withdrawn_at')
            ->exists();
    }
    
    /**
     * Get all consents for a contact
     */
    public function getConsents(int $contactId): array
    {
        $consents = ConsentRecord::where('contact_id', $contactId)
            ->orderBy('created_at', 'desc')
            ->get()
            ->groupBy('consent_type');
        
        return $consents->map(function ($records, $type) {
            $latest = $records->first();
            return [
                'type' => $type,
                'status' => $latest->status,
                'granted_at' => $latest->granted_at,
                'withdrawn_at' => $latest->withdrawn_at,
                'is_valid' => $latest->isValid(),
            ];
        })->values()->toArray();
    }
}
```

### Consent API Endpoints

```php
// app/Http/Controllers/Api/ConsentController.php
namespace App\Http\Controllers\Api;

use App\Services\ConsentService;
use Illuminate\Http\Request;

class ConsentController extends Controller
{
    public function __construct(
        private ConsentService $consentService
    ) {}
    
    /**
     * Grant consent
     * POST /api/v1/lgpd/consent
     */
    public function grant(Request $request)
    {
        $validated = $request->validate([
            'contact_id' => 'required|integer',
            'consent_type' => 'required|string|in:data_processing,health_data,marketing,data_sharing',
            'chatwoot_contact_id' => 'nullable|integer',
            'krayin_lead_id' => 'nullable|integer',
        ]);
        
        $consent = $this->consentService->grantConsent(
            $validated['contact_id'],
            $validated['consent_type'],
            $request,
            $validated['chatwoot_contact_id'] ?? null,
            $validated['krayin_lead_id'] ?? null
        );
        
        return response()->json([
            'success' => true,
            'consent_id' => $consent->id,
            'status' => 'granted',
            'granted_at' => $consent->granted_at,
        ], 201);
    }
    
    /**
     * Withdraw consent
     * DELETE /api/v1/lgpd/consent/{contact_id}/{consent_type}
     */
    public function withdraw(int $contactId, string $consentType)
    {
        $this->authorize('withdraw-consent', $contactId);
        
        $this->consentService->withdrawConsent($contactId, $consentType);
        
        return response()->json([
            'success' => true,
            'message' => 'Consent withdrawn successfully',
            'contact_id' => $contactId,
            'consent_type' => $consentType,
            'withdrawn_at' => now(),
        ]);
    }
    
    /**
     * Get all consents for a contact
     * GET /api/v1/lgpd/consent/{contact_id}
     */
    public function index(int $contactId)
    {
        $this->authorize('view-consent', $contactId);
        
        $consents = $this->consentService->getConsents($contactId);
        
        return response()->json([
            'success' => true,
            'contact_id' => $contactId,
            'consents' => $consents,
        ]);
    }
}
```

---

## 4. Data Subject Rights Implementation

### Right to Access (Art. 18, I)

**Endpoint**: `GET /api/v1/lgpd/export/{contact_id}`

```php
// app/Http/Controllers/Api/DataExportController.php
namespace App\Http\Controllers\Api;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;

class DataExportController extends Controller
{
    /**
     * Export all data for a contact (LGPD Art. 18, I)
     * GET /api/v1/lgpd/export/{contact_id}
     */
    public function export(Request $request, int $contactId)
    {
        $this->authorize('export-data', $contactId);
        
        // Gather all personal data
        $data = [
            'export_info' => [
                'contact_id' => $contactId,
                'generated_at' => now()->toIso8601String(),
                'format' => 'json',
                'lgpd_article' => 'Art. 18, I - Direito de Acesso',
            ],
            
            'personal_data' => $this->getPersonalData($contactId),
            'conversations' => $this->getConversations($contactId),
            'messages' => $this->getMessages($contactId),
            'consent_records' => $this->getConsentRecords($contactId),
            'audit_logs' => $this->getAuditLogs($contactId),
        ];
        
        // Log the export (LGPD requirement)
        AuditLog::create([
            'user_id' => auth()->id(),
            'action' => 'export',
            'model' => 'Contact',
            'model_id' => $contactId,
            'ip_address' => $request->ip(),
            'user_agent' => $request->userAgent(),
        ]);
        
        $filename = "data-export-{$contactId}-" . now()->format('Y-m-d') . ".json";
        
        return response()->json($data, 200)
            ->header('Content-Disposition', "attachment; filename=\"{$filename}\"")
            ->header('Content-Type', 'application/json');
    }
    
    private function getPersonalData(int $contactId): array
    {
        // Get from Chatwoot database
        $contact = DB::connection('chatwoot')
            ->table('contacts')
            ->where('id', $contactId)
            ->first();
        
        return [
            'name' => $contact->name ?? null,
            'email' => $contact->email ?? null,
            'phone_number' => $contact->phone_number ?? null,
            'created_at' => $contact->created_at ?? null,
        ];
    }
    
    private function getConversations(int $contactId): array
    {
        return DB::connection('chatwoot')
            ->table('conversations')
            ->where('contact_id', $contactId)
            ->select('id', 'status', 'created_at', 'updated_at')
            ->get()
            ->toArray();
    }
    
    private function getMessages(int $contactId): array
    {
        return DB::connection('chatwoot')
            ->table('messages')
            ->whereIn('conversation_id', function($query) use ($contactId) {
                $query->select('id')
                    ->from('conversations')
                    ->where('contact_id', $contactId);
            })
            ->select('id', 'content', 'message_type', 'created_at')
            ->get()
            ->toArray();
    }
    
    private function getConsentRecords(int $contactId): array
    {
        return ConsentRecord::where('contact_id', $contactId)
            ->orderBy('created_at', 'desc')
            ->get()
            ->toArray();
    }
    
    private function getAuditLogs(int $contactId): array
    {
        return AuditLog::where('model', 'Contact')
            ->where('model_id', $contactId)
            ->orderBy('created_at', 'desc')
            ->limit(100) // Last 100 access logs
            ->get()
            ->toArray();
    }
}
```

### Right to Erasure (Art. 18, VI)

**Endpoint**: `DELETE /api/v1/lgpd/data/{contact_id}`

```php
// app/Http/Controllers/Api/DataDeletionController.php
namespace App\Http\Controllers\Api;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;

class DataDeletionController extends Controller
{
    /**
     * Delete all data for a contact (LGPD Art. 18, VI)
     * DELETE /api/v1/lgpd/data/{contact_id}
     */
    public function delete(Request $request, int $contactId)
    {
        $this->authorize('delete-data', $contactId);
        
        $validated = $request->validate([
            'confirmation' => 'required|string|in:DELETE_ALL_DATA',
            'reason' => 'required|string|max:500',
        ]);
        
        DB::beginTransaction();
        
        try {
            $deletedData = [
                'contact_id' => $contactId,
                'deleted_at' => now(),
                'reason' => $validated['reason'],
                'counts' => [],
            ];
            
            // 1. Delete from Bridge service
            $deletedData['counts']['conversations'] = DB::table('conversation_mappings')
                ->join('contact_mappings', 'conversation_mappings.krayin_lead_id', '=', 'contact_mappings.krayin_lead_id')
                ->where('contact_mappings.chatwoot_contact_id', $contactId)
                ->delete();
            
            $deletedData['counts']['activities'] = DB::table('activity_mappings')
                ->whereIn('conversation_id', function($query) use ($contactId) {
                    $query->select('chatwoot_conversation_id')
                        ->from('conversation_mappings')
                        ->join('contact_mappings', 'conversation_mappings.krayin_lead_id', '=', 'contact_mappings.krayin_lead_id')
                        ->where('contact_mappings.chatwoot_contact_id', $contactId);
                })
                ->delete();
            
            $deletedData['counts']['contact_mappings'] = DB::table('contact_mappings')
                ->where('chatwoot_contact_id', $contactId)
                ->delete();
            
            // 2. Anonymize consent records (keep for legal compliance)
            $deletedData['counts']['consents_anonymized'] = ConsentRecord::where('contact_id', $contactId)
                ->update([
                    'ip_address' => '0.0.0.0',
                    'user_agent' => 'ANONYMIZED',
                ]);
            
            // 3. Delete from Chatwoot
            DB::connection('chatwoot')->table('messages')
                ->whereIn('conversation_id', function($query) use ($contactId) {
                    $query->select('id')
                        ->from('conversations')
                        ->where('contact_id', $contactId);
                })
                ->delete();
            
            DB::connection('chatwoot')->table('conversations')
                ->where('contact_id', $contactId)
                ->delete();
            
            DB::connection('chatwoot')->table('contacts')
                ->where('id', $contactId)
                ->delete();
            
            // 4. Delete from Krayin (via API)
            $krayinLeadId = DB::table('contact_mappings')
                ->where('chatwoot_contact_id', $contactId)
                ->value('krayin_lead_id');
            
            if ($krayinLeadId) {
                app(KrayinApiService::class)->deleteLead($krayinLeadId);
            }
            
            // 5. Log the deletion (must keep audit trail)
            AuditLog::create([
                'user_id' => auth()->id(),
                'action' => 'delete',
                'model' => 'Contact',
                'model_id' => $contactId,
                'changes' => $deletedData,
                'ip_address' => $request->ip(),
                'user_agent' => $request->userAgent(),
            ]);
            
            DB::commit();
            
            return response()->json([
                'success' => true,
                'message' => 'All data deleted successfully',
                'deleted_data' => $deletedData,
            ]);
            
        } catch (\Exception $e) {
            DB::rollBack();
            
            \Log::error('Data deletion failed', [
                'contact_id' => $contactId,
                'error' => $e->getMessage()
            ]);
            
            return response()->json([
                'success' => false,
                'error' => 'Data deletion failed',
                'message' => 'Please contact support',
            ], 500);
        }
    }
}
```

---

## 5. Data Retention and Anonymization

### Automated Retention Enforcement

```php
// app/Console/Commands/EnforceDataRetention.php
namespace App\Console\Commands;

use Illuminate\Console\Command;
use Illuminate\Support\Facades\DB;

class EnforceDataRetention extends Command
{
    protected $signature = 'lgpd:enforce-retention';
    protected $description = 'Enforce LGPD data retention policies';
    
    public function handle()
    {
        $this->info('Starting LGPD data retention enforcement...');
        
        // Personal data: 5 years
        $personalDataCutoff = now()->subYears(5);
        
        // Medical data: 20 years (CFM Resolution 1.821/2007)
        $medicalDataCutoff = now()->subYears(20);
        
        // 1. Anonymize old conversation data
        $conversationsAnonymized = DB::table('conversation_mappings')
            ->where('created_at', '<', $personalDataCutoff)
            ->whereNull('anonymized_at')
            ->update([
                'anonymized_at' => now(),
                'status' => 'anonymized'
            ]);
        
        $this->info("Anonymized {$conversationsAnonymized} conversations");
        
        // 2. Delete old activity logs (non-medical)
        $activitiesDeleted = DB::table('stage_change_logs')
            ->where('created_at', '<', $personalDataCutoff)
            ->delete();
        
        $this->info("Deleted {$activitiesDeleted} activity logs");
        
        // 3. Anonymize old audit logs (keep structure for compliance)
        $auditLogsAnonymized = AuditLog::where('created_at', '<', $personalDataCutoff)
            ->update([
                'ip_address' => '0.0.0.0',
                'user_agent' => 'ANONYMIZED'
            ]);
        
        $this->info("Anonymized {$auditLogsAnonymized} audit logs");
        
        // 4. Notify about medical data approaching retention limit
        $medicalDataApproaching = DB::connection('krayin')
            ->table('leads')
            ->where('created_at', '<', now()->subYears(19))
            ->where('created_at', '>', now()->subYears(20))
            ->count();
        
        if ($medicalDataApproaching > 0) {
            $this->warn("{$medicalDataApproaching} medical records approaching 20-year retention limit");
            // Send notification to DPO
            event(new MedicalDataRetentionWarning($medicalDataApproaching));
        }
        
        // 5. Log retention enforcement
        \Log::info('LGPD data retention enforced', [
            'conversations_anonymized' => $conversationsAnonymized,
            'activities_deleted' => $activitiesDeleted,
            'audit_logs_anonymized' => $auditLogsAnonymized,
            'cutoff_date_personal' => $personalDataCutoff,
            'cutoff_date_medical' => $medicalDataCutoff,
        ]);
        
        $this->info('Data retention enforcement completed');
        
        return Command::SUCCESS;
    }
}

// Schedule in app/Console/Kernel.php
protected function schedule(Schedule $schedule)
{
    // Run on first day of each month at 2 AM
    $schedule->command('lgpd:enforce-retention')
        ->monthlyOn(1, '02:00')
        ->sendOutputTo(storage_path('logs/retention.log'))
        ->emailOutputOnFailure('dpo@yourdomain.com');
}
```

---

## 6. Privacy Policy (Portuguese)

### Complete Privacy Policy Template

```markdown
# POL√çTICA DE PRIVACIDADE E PROTE√á√ÉO DE DADOS

**√öltima atualiza√ß√£o**: 08 de outubro de 2025  
**Vers√£o**: 1.0

## 1. INTRODU√á√ÉO

Esta Pol√≠tica de Privacidade descreve como [NOME DA CL√çNICA] ("n√≥s", "nosso" ou "cl√≠nica") coleta, usa, armazena e protege suas informa√ß√µes pessoais em conformidade com a Lei Geral de Prote√ß√£o de Dados (LGPD - Lei n¬∫ 13.709/2018).

## 2. ENCARREGADO DE PROTE√á√ÉO DE DADOS (DPO)

**Nome**: [NOME DO DPO]  
**E-mail**: dpo@suaclinica.com.br  
**Telefone**: (11) XXXX-XXXX  
**Endere√ßo**: [ENDERE√áO COMPLETO]

## 3. DADOS COLETADOS

### 3.1 Dados Pessoais
- Nome completo
- CPF
- Data de nascimento
- E-mail
- Telefone
- Endere√ßo

### 3.2 Dados Sens√≠veis de Sa√∫de
- Hist√≥rico m√©dico
- Diagn√≥sticos
- Tratamentos realizados
- Medicamentos prescritos
- Resultados de exames
- Alergias e condi√ß√µes pr√©-existentes

### 3.3 Dados de Comunica√ß√£o
- Mensagens de chat (WhatsApp, Instagram, Facebook, Web)
- Hist√≥rico de conversas
- Registros de atendimento

### 3.4 Dados T√©cnicos
- Endere√ßo IP
- Tipo de navegador
- Sistema operacional
- Cookies (com seu consentimento)

## 4. FINALIDADE DO TRATAMENTO

Utilizamos seus dados pessoais para:

### 4.1 Atendimento M√©dico (Base Legal: Consentimento + Execu√ß√£o de Contrato)
- Presta√ß√£o de servi√ßos de sa√∫de
- Manuten√ß√£o de hist√≥rico m√©dico
- Agendamento de consultas
- Acompanhamento de tratamentos

### 4.2 Comunica√ß√£o (Base Legal: Consentimento)
- Atendimento via chat multicanal
- Envio de lembretes de consultas
- Comunica√ß√£o sobre resultados de exames
- Notifica√ß√µes importantes

### 4.3 Obriga√ß√µes Legais (Base Legal: Obriga√ß√£o Legal)
- Cumprimento de requisitos do Conselho Federal de Medicina (CFM)
- Atendimento a requisi√ß√µes judiciais
- Manuten√ß√£o de registros cont√°beis

### 4.4 Marketing (Base Legal: Consentimento - Opcional)
- Envio de informa√ß√µes sobre novos servi√ßos
- Promo√ß√µes e campanhas
- Pesquisas de satisfa√ß√£o

## 5. COMPARTILHAMENTO DE DADOS

### 5.1 Compartilhamento Necess√°rio
Seus dados podem ser compartilhados com:
- **Laborat√≥rios**: Para realiza√ß√£o de exames
- **Planos de sa√∫de**: Para faturamento e autoriza√ß√£o
- **Autoridades de sa√∫de**: Quando exigido por lei
- **Prestadores de servi√ßo**: Tecnologia, armazenamento (com contratos de confidencialidade)

### 5.2 N√£o Compartilhamos Com
- Empresas de marketing de terceiros
- Redes sociais (sem seu consentimento)
- Outras cl√≠nicas ou m√©dicos (sem seu consentimento)

## 6. SEGURAN√áA DOS DADOS

Implementamos medidas t√©cnicas e organizacionais para proteger seus dados:

### 6.1 Medidas T√©cnicas
- Criptografia de dados em tr√¢nsito (HTTPS/TLS)
- Criptografia de dados em repouso (banco de dados)
- Criptografia de campo para dados sens√≠veis de sa√∫de
- Firewall e sistemas de detec√ß√£o de intrus√£o
- Backups di√°rios autom√°ticos
- Autentica√ß√£o de dois fatores para equipe

### 6.2 Medidas Organizacionais
- Treinamento de equipe em LGPD
- Pol√≠tica de acesso baseado em necessidade
- Contratos de confidencialidade
- Auditoria regular de acesso
- Plano de resposta a incidentes

## 7. RETEN√á√ÉO DE DADOS

### 7.1 Dados M√©dicos
- **Prazo**: 20 anos (Resolu√ß√£o CFM n¬∫ 1.821/2007)
- **Ap√≥s o prazo**: Dados anonimizados para fins estat√≠sticos

### 7.2 Dados de Comunica√ß√£o
- **Prazo**: 5 anos (LGPD)
- **Ap√≥s o prazo**: Exclus√£o permanente

### 7.3 Dados de Auditoria
- **Prazo**: 5 anos (LGPD)
- **Ap√≥s o prazo**: Anonimiza√ß√£o

## 8. SEUS DIREITOS (Art. 18 da LGPD)

Voc√™ tem direito a:

### 8.1 Confirma√ß√£o e Acesso (Incisos I e II)
- Confirmar se tratamos seus dados
- Acessar seus dados pessoais

### 8.2 Corre√ß√£o (Inciso III)
- Corrigir dados incompletos, inexatos ou desatualizados

### 8.3 Anonimiza√ß√£o, Bloqueio ou Elimina√ß√£o (Inciso IV)
- Solicitar anonimiza√ß√£o de dados desnecess√°rios
- Bloquear ou eliminar dados excessivos

### 8.4 Portabilidade (Inciso V)
- Receber seus dados em formato estruturado e interoper√°vel

### 8.5 Elimina√ß√£o (Inciso VI)
- Excluir dados tratados com base em consentimento
- **Exce√ß√£o**: Dados m√©dicos devem ser mantidos por 20 anos (obriga√ß√£o legal)

### 8.6 Informa√ß√£o sobre Compartilhamento (Inciso VII)
- Saber com quem compartilhamos seus dados

### 8.7 Revoga√ß√£o do Consentimento (Inciso IX)
- Retirar consentimento a qualquer momento

## 9. COMO EXERCER SEUS DIREITOS

### 9.1 Canais de Atendimento
**E-mail**: dpo@suaclinica.com.br  
**Telefone**: (11) XXXX-XXXX  
**Presencial**: [ENDERE√áO] - Segunda a Sexta, 9h √†s 17h  
**Portal Online**: https://suaclinica.com.br/lgpd

### 9.2 Prazo de Resposta
- Confirma√ß√£o imediata do recebimento da solicita√ß√£o
- Resposta em at√© 15 dias √∫teis
- Prorroga√ß√£o por mais 10 dias (se necess√°rio, com justificativa)

### 9.3 Documenta√ß√£o Necess√°ria
- Documento de identifica√ß√£o (RG ou CNH)
- Comprovante de resid√™ncia (se aplic√°vel)
- Descri√ß√£o clara da solicita√ß√£o

## 10. COOKIES E TECNOLOGIAS SEMELHANTES

### 10.1 Uso de Cookies
Utilizamos cookies para:
- Manter sua sess√£o ativa
- Melhorar a experi√™ncia do usu√°rio
- Analisar uso do site (com consentimento)

### 10.2 Gerenciamento de Cookies
Voc√™ pode:
- Aceitar todos os cookies
- Rejeitar cookies n√£o essenciais
- Gerenciar prefer√™ncias a qualquer momento

## 11. TRANSFER√äNCIA INTERNACIONAL DE DADOS

**N√£o realizamos** transfer√™ncia internacional de dados. Todos os dados s√£o armazenados em servidores localizados no Brasil.

## 12. ALTERA√á√ïES NESTA POL√çTICA

### 12.1 Notifica√ß√£o de Mudan√ßas
- Notificaremos por e-mail sobre altera√ß√µes significativas
- Publicaremos nova vers√£o no site com 30 dias de anteced√™ncia
- Vers√£o anterior dispon√≠vel para consulta

### 12.2 Hist√≥rico de Vers√µes
- v1.0 (08/10/2025): Vers√£o inicial

## 13. LEGISLA√á√ÉO APLIC√ÅVEL

Esta pol√≠tica √© regida pela:
- Lei Geral de Prote√ß√£o de Dados (Lei n¬∫ 13.709/2018)
- C√≥digo de Defesa do Consumidor (Lei n¬∫ 8.078/1990)
- Marco Civil da Internet (Lei n¬∫ 12.965/2014)
- Resolu√ß√£o CFM n¬∫ 1.821/2007 (Prontu√°rio M√©dico)

## 14. CONSENTIMENTO

Ao utilizar nossos servi√ßos, voc√™ declara ter lido e compreendido esta Pol√≠tica de Privacidade e concorda com o tratamento de seus dados pessoais conforme descrito.

**Para dados sens√≠veis de sa√∫de**, coletamos consentimento expl√≠cito e espec√≠fico antes do primeiro atendimento.

## 15. CONTATO

Para d√∫vidas sobre esta pol√≠tica ou sobre o tratamento de seus dados:

**Encarregado de Prote√ß√£o de Dados (DPO)**  
E-mail: dpo@suaclinica.com.br  
Telefone: (11) XXXX-XXXX  
Endere√ßo: [ENDERE√áO COMPLETO]

**√öltima atualiza√ß√£o**: 08 de outubro de 2025
```

---

## 7. Data Protection Impact Assessment (DPIA)

### DPIA Template (Relat√≥rio de Impacto √† Prote√ß√£o de Dados)

```markdown
# RELAT√ìRIO DE IMPACTO √Ä PROTE√á√ÉO DE DADOS PESSOAIS (RIPD)
## Sistema de CRM e LiveChat para Cl√≠nicas de Sa√∫de

**Data**: 08 de outubro de 2025  
**Vers√£o**: 1.0  
**Respons√°vel**: [Nome do DPO]

---

## 1. IDENTIFICA√á√ÉO DO TRATAMENTO

### 1.1 Descri√ß√£o do Sistema
Sistema integrado de CRM (Krayin) e LiveChat (Chatwoot) para gest√£o de atendimento em cl√≠nicas de sa√∫de, com foco em comunica√ß√£o omnicanal (WhatsApp, Instagram, Facebook, Web).

### 1.2 Controlador
**Nome**: [Nome da Cl√≠nica]  
**CNPJ**: XX.XXX.XXX/XXXX-XX  
**Endere√ßo**: [Endere√ßo Completo]  
**DPO**: [Nome e Contato]

### 1.3 Operadores
- **Krayin CRM**: Fornecedor de software CRM
- **Chatwoot**: Fornecedor de software LiveChat
- **Provedor de Hospedagem**: [Nome do provedor VPS]

---

## 2. NECESSIDADE E PROPORCIONALIDADE

### 2.1 Finalidade do Tratamento
- Atendimento m√©dico e odontol√≥gico
- Gest√£o de relacionamento com pacientes
- Hist√≥rico de conversas para continuidade de cuidado
- An√°lise de desempenho de atendimento

### 2.2 Minimiza√ß√£o de Dados
‚úÖ **Implementado**:
- Coleta apenas dados necess√°rios para atendimento
- Campos opcionais claramente marcados
- Dados de marketing coletados apenas com consentimento espec√≠fico

### 2.3 Proporcionalidade
‚úÖ **Adequado**: O volume de dados coletados √© proporcional √†s finalidades declaradas.

---

## 3. AVALIA√á√ÉO DE RISCOS

### 3.1 Riscos Identificados

| Risco | Probabilidade | Impacto | N√≠vel | Mitiga√ß√£o |
|-------|---------------|---------|-------|-----------|
| Acesso n√£o autorizado a dados m√©dicos | M√©dia | Muito Alto | **ALTO** | Criptografia + 2FA + Auditoria |
| Vazamento de dados por falha t√©cnica | Baixa | Alto | **M√âDIO** | Backups + Testes + Monitoramento |
| Uso indevido por colaboradores | M√©dia | Alto | **M√âDIO** | Treinamento + Controle de acesso |
| Ataque cibern√©tico (ransomware) | Baixa | Muito Alto | **M√âDIO** | Firewall + Antiv√≠rus + Backups offline |
| Perda de dados por falha de hardware | Baixa | Alto | **M√âDIO** | Redund√¢ncia + Backups + DR plan |
| N√£o conformidade com CFM | Baixa | M√©dio | **BAIXO** | Reten√ß√£o de 20 anos + Auditoria |

### 3.2 An√°lise de Impacto aos Titulares

**Impacto Potencial**:
- Discrimina√ß√£o por condi√ß√£o de sa√∫de
- Constrangimento p√∫blico
- Fraude de identidade
- Chantagem
- Perda de confian√ßa

**Probabilidade**: Baixa (com medidas de seguran√ßa implementadas)

---

## 4. MEDIDAS DE SEGURAN√áA

### 4.1 Medidas T√©cnicas Implementadas

‚úÖ **Criptografia**:
- TLS 1.3 para dados em tr√¢nsito
- AES-256 para dados em repouso
- Criptografia de campo para dados sens√≠veis

‚úÖ **Controle de Acesso**:
- Autentica√ß√£o de dois fatores (2FA)
- Controle baseado em fun√ß√µes (RBAC)
- Princ√≠pio do menor privil√©gio

‚úÖ **Monitoramento**:
- Logs de auditoria completos
- Alertas de seguran√ßa automatizados
- Revis√£o mensal de acessos

‚úÖ **Backup e Recupera√ß√£o**:
- Backups di√°rios autom√°ticos
- Reten√ß√£o de 30 dias
- Teste de restaura√ß√£o mensal
- RTO: 4 horas / RPO: 24 horas

### 4.2 Medidas Organizacionais Implementadas

‚úÖ **Pol√≠ticas e Procedimentos**:
- Pol√≠tica de Seguran√ßa da Informa√ß√£o
- Pol√≠tica de Privacidade publicada
- Procedimento de Resposta a Incidentes
- Pol√≠tica de Reten√ß√£o de Dados

‚úÖ **Treinamento**:
- Treinamento LGPD obrigat√≥rio para toda equipe
- Reciclagem anual
- Conscientiza√ß√£o cont√≠nua

‚úÖ **Contratos**:
- Cl√°usulas de prote√ß√£o de dados em contratos
- Termos de Confidencialidade assinados
- DPA (Data Processing Agreement) com operadores

---

## 5. CONFORMIDADE LEGAL

### 5.1 Bases Legais

| Tipo de Dado | Base Legal (Art. 7¬∫ e 11 LGPD) |
|--------------|-------------------------------|
| Dados pessoais (nome, contato) | Consentimento + Execu√ß√£o de contrato |
| Dados sens√≠veis de sa√∫de | Consentimento espec√≠fico + Tutela da sa√∫de |
| Dados de comunica√ß√£o | Consentimento |
| Dados de auditoria | Obriga√ß√£o legal |
| Dados de IP (seguran√ßa) | Leg√≠timo interesse |

### 5.2 Conformidade com CFM
‚úÖ Resolu√ß√£o CFM n¬∫ 1.821/2007 - Reten√ß√£o de 20 anos para prontu√°rios m√©dicos

### 5.3 Transfer√™ncia Internacional
‚ùå **N√£o realizada**: Todos os dados permanecem no Brasil

---

## 6. DIREITOS DOS TITULARES

### 6.1 Mecanismos Implementados

‚úÖ **Portal de Privacidade**:
- URL: https://clinica.com.br/lgpd
- Funcionalidades:
  - Visualizar dados pessoais
  - Solicitar corre√ß√£o
  - Exportar dados (portabilidade)
  - Solicitar exclus√£o
  - Gerenciar consentimentos

‚úÖ **Canais de Atendimento**:
- E-mail: dpo@clinica.com.br
- Telefone: (11) XXXX-XXXX
- Presencial: Endere√ßo da cl√≠nica

‚úÖ **Prazo de Resposta**: 15 dias √∫teis (conforme Art. 19 LGPD)

---

## 7. INCIDENTES DE SEGURAN√áA

### 7.1 Plano de Resposta a Incidentes

**Procedimento**:
1. **Detec√ß√£o** (0-1h): Identificar e classificar incidente
2. **Conten√ß√£o** (1-4h): Isolar sistemas afetados
3. **An√°lise** (4-24h): Avaliar extens√£o e impacto
4. **Notifica√ß√£o** (24-72h): Comunicar ANPD e titulares
5. **Remedia√ß√£o** (1-7 dias): Corrigir vulnerabilidades
6. **Documenta√ß√£o**: Relat√≥rio completo do incidente

### 7.2 Notifica√ß√£o √† ANPD
‚úÖ **Processo definido**: Notifica√ß√£o em at√© 72 horas para incidentes com risco aos titulares

---

## 8. CONCLUS√ÉO

### 8.1 Resumo dos Riscos

| N√≠vel de Risco | Quantidade | Status |
|----------------|------------|--------|
| Alto | 1 | Mitigado |
| M√©dio | 4 | Mitigado |
| Baixo | 1 | Aceit√°vel |

### 8.2 Recomenda√ß√µes

1. ‚úÖ **Implementadas**:
   - Criptografia end-to-end
   - Auditoria completa
   - Treinamento de equipe
   - Portal de privacidade

2. üîÑ **Em andamento**:
   - Certifica√ß√£o ISO 27001
   - Teste de penetra√ß√£o anual

3. üìã **Planejadas**:
   - Sistema de detec√ß√£o de anomalias (IA)
   - Seguro cibern√©tico

### 8.3 Aprova√ß√£o

Este RIPD foi revisado e aprovado por:

**DPO**: ________________________  
Data: ___/___/______

**Diretor Cl√≠nico**: ________________________  
Data: ___/___/______

**Pr√≥xima Revis√£o**: Outubro de 2026
```

---

## 8. Security Audit Checklist

### Pre-Launch Security Audit

```markdown
# LGPD SECURITY AUDIT CHECKLIST

## A. CONSENT MANAGEMENT
- [ ] Pre-chat consent form implemented
- [ ] Consent recorded in database with timestamp
- [ ] IP address and user agent logged
- [ ] Consent version tracked
- [ ] Withdrawal mechanism functional
- [ ] Consent history available for review

## B. DATA ENCRYPTION
- [ ] HTTPS/TLS enabled (grade A+ on SSL Labs)
- [ ] Database encryption at rest enabled
- [ ] Field-level encryption for sensitive data
- [ ] Backup files encrypted
- [ ] Redis password protected
- [ ] No plain-text passwords in code

## C. ACCESS CONTROL
- [ ] Role-based access control (RBAC) implemented
- [ ] Least privilege principle enforced
- [ ] Two-factor authentication enabled
- [ ] Session timeout configured (60 minutes)
- [ ] Failed login attempts limited
- [ ] Password complexity requirements enforced

## D. AUDIT LOGGING
- [ ] All data access logged
- [ ] User actions tracked
- [ ] System events recorded
- [ ] Logs immutable (append-only)
- [ ] Log retention: 5 years
- [ ] Logs reviewed monthly

## E. DATA RETENTION
- [ ] Automated retention enforcement scheduled
- [ ] Personal data: 5-year retention
- [ ] Medical data: 20-year retention
- [ ] Old data anonymization working
- [ ] Retention policy documented
- [ ] DPO notified of approaching limits

## F. DATA SUBJECT RIGHTS
- [ ] Data export API functional
- [ ] Data deletion API functional
- [ ] Consent management API functional
- [ ] Portal for self-service available
- [ ] 15-day response SLA configured
- [ ] DPO contact information published

## G. SECURITY MEASURES
- [ ] Firewall configured
- [ ] Intrusion detection system active
- [ ] Automated backups daily
- [ ] Backup restoration tested
- [ ] Disaster recovery plan documented
- [ ] Incident response plan documented

## H. DOCUMENTATION
- [ ] Privacy policy published (Portuguese)
- [ ] DPIA completed and approved
- [ ] Security policies documented
- [ ] DPO appointed and registered
- [ ] Data processing agreements signed
- [ ] Employee confidentiality agreements signed

## I. TRAINING
- [ ] LGPD training completed (all staff)
- [ ] Security awareness training completed
- [ ] Incident response training completed
- [ ] Training records maintained
- [ ] Annual refresher scheduled

## J. THIRD-PARTY COMPLIANCE
- [ ] Vendor security assessments completed
- [ ] DPAs signed with all processors
- [ ] Vendor compliance verified
- [ ] Data sharing documented
- [ ] Vendor access monitored

---

**Audit Date**: ___/___/______  
**Auditor**: ________________________  
**Result**: [ ] Pass [ ] Fail [ ] Pass with conditions  
**Next Audit**: ___/___/______
```

---

## 9. Incident Response Plan

### Data Breach Response Procedure

```markdown
# PLANO DE RESPOSTA A INCIDENTES DE SEGURAN√áA

## FASE 1: DETEC√á√ÉO E CLASSIFICA√á√ÉO (0-1 hora)

### 1.1 Detec√ß√£o
**Canais de detec√ß√£o**:
- Alertas automatizados (monitoring)
- Relat√≥rios de usu√°rios
- Auditorias de seguran√ßa
- Terceiros (pesquisadores de seguran√ßa)

### 1.2 Classifica√ß√£o de Severidade

| N√≠vel | Descri√ß√£o | Exemplos |
|-------|-----------|----------|
| **Cr√≠tico** | Acesso n√£o autorizado a dados sens√≠veis de sa√∫de | Vazamento de prontu√°rios |
| **Alto** | Acesso n√£o autorizado a dados pessoais | Vazamento de contatos |
| **M√©dio** | Tentativa de acesso bloqueada | Ataque DDoS mitigado |
| **Baixo** | Evento de seguran√ßa sem impacto | Scan de portas |

### 1.3 Acionamento
**Cr√≠tico/Alto**: Acionar DPO e equipe de seguran√ßa imediatamente  
**M√©dio/Baixo**: Registrar e revisar no pr√≥ximo dia √∫til

## FASE 2: CONTEN√á√ÉO (1-4 horas)

### 2.1 A√ß√µes Imediatas
- [ ] Isolar sistemas afetados
- [ ] Bloquear acessos suspeitos
- [ ] Desativar contas comprometidas
- [ ] Preservar evid√™ncias (logs, backups)
- [ ] Documentar todas as a√ß√µes

### 2.2 Comunica√ß√£o Interna
- Notificar dire√ß√£o da cl√≠nica
- Convocar comit√™ de crise
- Ativar plano de conting√™ncia

## FASE 3: AN√ÅLISE (4-24 horas)

### 3.1 Investiga√ß√£o
- Determinar causa raiz
- Identificar dados afetados
- Quantificar titulares impactados
- Avaliar risco aos titulares

### 3.2 Documenta√ß√£o
- Linha do tempo do incidente
- Sistemas e dados afetados
- A√ß√µes de conten√ß√£o realizadas
- Evid√™ncias coletadas

## FASE 4: NOTIFICA√á√ÉO (24-72 horas)

### 4.1 Notifica√ß√£o √† ANPD
**Prazo**: 72 horas (Art. 48, ¬ß 1¬∫ LGPD)

**Conte√∫do da notifica√ß√£o**:
- Descri√ß√£o do incidente
- Dados pessoais afetados
- Titulares impactados (quantidade)
- Medidas de conten√ß√£o
- Riscos aos titulares
- Medidas de mitiga√ß√£o

**Canal**: https://www.gov.br/anpd/pt-br

### 4.2 Notifica√ß√£o aos Titulares
**Quando notificar**:
- Risco relevante aos direitos e liberdades
- Possibilidade de dano patrimonial, moral ou reputacional

**Conte√∫do**:
- Descri√ß√£o clara do incidente
- Dados afetados
- Medidas adotadas
- Recomenda√ß√µes de prote√ß√£o
- Canais de contato (DPO)

**Canais**:
- E-mail direto
- SMS (casos urgentes)
- Publica√ß√£o no site (se imposs√≠vel contato individual)

## FASE 5: REMEDIA√á√ÉO (1-7 dias)

### 5.1 Corre√ß√£o de Vulnerabilidades
- Aplicar patches de seguran√ßa
- Alterar credenciais comprometidas
- Revisar configura√ß√µes de seguran√ßa
- Atualizar regras de firewall

### 5.2 Recupera√ß√£o
- Restaurar servi√ßos afetados
- Validar integridade dos dados
- Testar funcionalidades
- Monitorar por atividades suspeitas

## FASE 6: DOCUMENTA√á√ÉO E APRENDIZADO (7-30 dias)

### 6.1 Relat√≥rio P√≥s-Incidente
- Cronologia completa
- Causa raiz
- Impacto aos titulares
- Efic√°cia da resposta
- Li√ß√µes aprendidas
- Recomenda√ß√µes

### 6.2 Melhorias
- Atualizar pol√≠ticas
- Implementar controles adicionais
- Treinar equipe
- Revisar plano de resposta

---

## CONTATOS DE EMERG√äNCIA

**DPO**: [Nome] - [Telefone] - dpo@clinica.com.br  
**TI**: [Nome] - [Telefone] - ti@clinica.com.br  
**Dire√ß√£o**: [Nome] - [Telefone]  
**Advogado**: [Nome] - [Telefone]  
**ANPD**: https://www.gov.br/anpd/pt-br  
**Pol√≠cia Federal**: 197
```

---

## 10. Training Materials

### Employee LGPD Training Checklist

```markdown
# TREINAMENTO LGPD - CHECKLIST

## M√ìDULO 1: INTRODU√á√ÉO √Ä LGPD
- [ ] O que √© LGPD
- [ ] Por que a LGPD √© importante
- [ ] Penalidades por n√£o conformidade
- [ ] Papel de cada colaborador

## M√ìDULO 2: CONCEITOS B√ÅSICOS
- [ ] Dados pessoais vs dados sens√≠veis
- [ ] Titulares de dados
- [ ] Controlador vs Operador
- [ ] Encarregado (DPO)

## M√ìDULO 3: PRINC√çPIOS DA LGPD
- [ ] Finalidade
- [ ] Necessidade
- [ ] Transpar√™ncia
- [ ] Seguran√ßa

## M√ìDULO 4: BASES LEGAIS
- [ ] Consentimento
- [ ] Execu√ß√£o de contrato
- [ ] Obriga√ß√£o legal
- [ ] Leg√≠timo interesse

## M√ìDULO 5: DIREITOS DOS TITULARES
- [ ] Acesso aos dados
- [ ] Corre√ß√£o
- [ ] Portabilidade
- [ ] Elimina√ß√£o

## M√ìDULO 6: BOAS PR√ÅTICAS
- [ ] Como coletar consentimento
- [ ] Como manejar dados sens√≠veis
- [ ] Quando compartilhar dados
- [ ] Como reportar incidentes

## M√ìDULO 7: SEGURAN√áA DA INFORMA√á√ÉO
- [ ] Senhas fortes
- [ ] Autentica√ß√£o de dois fatores
- [ ] Phishing e engenharia social
- [ ] Uso de dispositivos pessoais

## M√ìDULO 8: CASOS PR√ÅTICOS
- [ ] Cen√°rios do dia a dia
- [ ] Quiz de avalia√ß√£o
- [ ] Discuss√£o de casos reais

---

**Nome**: ________________________  
**Data**: ___/___/______  
**Assinatura**: ________________________  
**Pr√≥xima Reciclagem**: ___/___/______
```

---

**Document Version**: 1.0  
**Last Updated**: October 08, 2025  
**Compliance Status**: ‚úÖ LGPD Ready